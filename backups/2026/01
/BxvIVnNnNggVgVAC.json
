{
  "active": false,
  "connections": {
    "Webhook Principal": {
      "main": [
        [
          {
            "node": "Orquestrador - Inicializar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Orquestrador - Inicializar": {
      "main": [
        [
          {
            "node": "Orquestrador - Preparar Prompt",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Orquestrador - Preparar Prompt": {
      "main": [
        [
          {
            "node": "Orquestrador - Claude",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Orquestrador - Claude": {
      "main": [
        [
          {
            "node": "Orquestrador - Processar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Orquestrador - Processar": {
      "main": [
        [
          {
            "node": "Switch Troubleshooting",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch Troubleshooting": {
      "main": [
        [
          {
            "node": "TS Infra - Prompt",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "TS Containers - Prompt",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "TS DB - Prompt",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "TS Dev - Prompt",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TS Infra - Prompt": {
      "main": [
        [
          {
            "node": "TS Infra - Claude",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TS Infra - Claude": {
      "main": [
        [
          {
            "node": "Agregar Troubleshooting",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TS Containers - Prompt": {
      "main": [
        [
          {
            "node": "TS Containers - Claude",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TS Containers - Claude": {
      "main": [
        [
          {
            "node": "Agregar Troubleshooting",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TS DB - Prompt": {
      "main": [
        [
          {
            "node": "TS DB - Claude",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TS DB - Claude": {
      "main": [
        [
          {
            "node": "Agregar Troubleshooting",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TS Dev - Prompt": {
      "main": [
        [
          {
            "node": "TS Dev - Claude",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TS Dev - Claude": {
      "main": [
        [
          {
            "node": "Agregar Troubleshooting",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Agregar Troubleshooting": {
      "main": [
        [
          {
            "node": "Switch Resolution",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch Resolution": {
      "main": [
        [
          {
            "node": "Resolutor Infra - Prompt",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Resolutor Containers - Prompt",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Resolutor DB - Prompt",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Resolutor Dev - Prompt",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Resolutor Infra - Prompt": {
      "main": [
        [
          {
            "node": "Resolutor Infra - Claude",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Resolutor Infra - Claude": {
      "main": [
        [
          {
            "node": "Agregar Resultados Finais",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Resolutor Containers - Prompt": {
      "main": [
        [
          {
            "node": "Resolutor Containers - Claude",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Resolutor Containers - Claude": {
      "main": [
        [
          {
            "node": "Agregar Resultados Finais",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Resolutor DB - Prompt": {
      "main": [
        [
          {
            "node": "Resolutor DB - Claude",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Resolutor DB - Claude": {
      "main": [
        [
          {
            "node": "Agregar Resultados Finais",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Resolutor Dev - Prompt": {
      "main": [
        [
          {
            "node": "Resolutor Dev - Claude",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Resolutor Dev - Claude": {
      "main": [
        [
          {
            "node": "Agregar Resultados Finais",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Agregar Resultados Finais": {
      "main": [
        [
          {
            "node": "Resposta Final",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2026-01-23T07:02:16.829Z",
  "id": "BxvIVnNnNggVgVAC",
  "isArchived": false,
  "meta": null,
  "name": "CredGestor - Sistema Multi-Agente Orquestrado",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "orquestrador",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "731c459c-b62d-4ba3-92ca-f44d24274296",
      "name": "Webhook Principal",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -1328,
        272
      ],
      "webhookId": "orquestrador-main"
    },
    {
      "parameters": {
        "jsCode": "const payload = $input.item.json.body || $input.item.json;\n\nreturn [{\n  json: {\n    sessionId: payload.sessionId || Date.now().toString(),\n    timestamp: new Date().toISOString(),\n    problem: payload.problem || 'Analise geral do sistema',\n    context: payload.context || {},\n    orchestrator: {\n      name: 'Agente Orquestrador',\n      version: '1.0',\n      status: 'analyzing'\n    }\n  }\n}];"
      },
      "id": "9c9d3569-9fa3-42e3-9cd1-384329e89e3b",
      "name": "Orquestrador - Inicializar",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1104,
        272
      ]
    },
    {
      "parameters": {
        "jsCode": "const data = $input.item.json;\n\nconst prompt = `Voce e o Agente Orquestrador do sistema CredGestor.\n\nPROBLEMA REPORTADO:\n${data.problem}\n\nCONTEXTO:\n${JSON.stringify(data.context, null, 2)}\n\nSUA TAREFA:\nAnalise o problema e determine quais agentes especialistas devem ser acionados.\n\nAGENTES DISPONIVEIS:\n1. Troubleshooting Infra - Diagnostico de infraestrutura (servidor, rede, recursos)\n2. Troubleshooting Containers - Diagnostico de Docker Swarm e containers\n3. Troubleshooting DB - Diagnostico de banco de dados\n4. Troubleshooting Dev - Diagnostico de codigo e aplicacao\n\n5. Resolutor Infra - Execucao de comandos de infraestrutura\n6. Resolutor Containers - Execucao de comandos Docker\n7. Resolutor DB - Execucao de queries e manutencao DB\n8. Resolutor Dev - Correcao de codigo e deploys\n\nRESPONDA EM JSON:\n{\n  \"decision\": {\n    \"strategy\": \"sequential|parallel\",\n    \"agentsToCall\": [\"agent1\", \"agent2\"],\n    \"priority\": \"critical|high|medium|low\",\n    \"reasoning\": \"explicacao da decisao\"\n  }\n}`;\n\nreturn [{\n  json: {\n    ...data,\n    prompt: prompt,\n    model: 'claude-3-5-sonnet-20241022'\n  }\n}];"
      },
      "id": "ba6c1e74-3462-4af0-83dc-80af87c18f5f",
      "name": "Orquestrador - Preparar Prompt",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -880,
        272
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.anthropic.com/v1/messages",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "x-api-key",
              "value": "={{ $env.ANTHROPIC_API_KEY }}"
            },
            {
              "name": "anthropic-version",
              "value": "2023-06-01"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {}
          ]
        },
        "options": {}
      },
      "id": "b2923580-c87b-4dc2-8f4f-df4a1948ad7d",
      "name": "Orquestrador - Claude",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -656,
        272
      ]
    },
    {
      "parameters": {
        "jsCode": "const data = $('Orquestrador - Inicializar').item.json;\nconst llmResponse = $input.item.json;\n\nlet decision = {};\nlet responseBody = llmResponse.body || llmResponse;\n\nif (typeof responseBody === 'string') {\n  try { responseBody = JSON.parse(responseBody); } catch (e) {}\n}\n\nif (responseBody.content && Array.isArray(responseBody.content)) {\n  const textContent = responseBody.content.find(c => c.type === 'text');\n  const analysisText = textContent ? textContent.text : '';\n  \n  try {\n    const jsonMatch = analysisText.match(/\\{[\\s\\S]*\\}/);\n    if (jsonMatch) {\n      decision = JSON.parse(jsonMatch[0]).decision || {};\n    }\n  } catch (e) {}\n}\n\nreturn [{\n  json: {\n    ...data,\n    orchestratorDecision: decision,\n    nextStep: 'troubleshooting'\n  }\n}];"
      },
      "id": "ce33b8fb-bc07-468a-9467-5db0edcc7262",
      "name": "Orquestrador - Processar",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -448,
        272
      ]
    },
    {
      "parameters": {
        "mode": "expression",
        "output": "multipleOutputs"
      },
      "id": "48415e5a-ac6b-4264-9388-4a43e07d18e2",
      "name": "Switch Troubleshooting",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [
        -256,
        240
      ]
    },
    {
      "parameters": {
        "jsCode": "const data = $input.item.json;\n\nconst prompt = `Voce e o Agente Troubleshooting de Infraestrutura.\n\nCONTEXTO:\n- VPS: 167.235.76.26\n- SO: Ubuntu 24.04\n- RAM: 16GB, CPU: 8 cores\n\nPROBLEMA:\n${data.problem}\n\nTAREFA:\n1. Diagnosticar problemas de infraestrutura\n2. Verificar recursos (CPU, memoria, disco)\n3. Analisar logs do sistema\n4. Identificar gargalos\n\nRESPONDA EM JSON:\n{\n  \"diagnosis\": {\n    \"summary\": \"resumo\",\n    \"issues\": [],\n    \"severity\": \"high|medium|low\"\n  },\n  \"recommendations\": []\n}`;\n\nreturn [{\n  json: {\n    ...data,\n    agentType: 'troubleshooting-infra',\n    prompt: prompt,\n    model: 'claude-3-5-sonnet-20241022'\n  }\n}];"
      },
      "id": "93e8fd20-fb1f-4976-8a58-07e764ac1c15",
      "name": "TS Infra - Prompt",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        0,
        -32
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.anthropic.com/v1/messages",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "x-api-key",
              "value": "={{ $env.ANTHROPIC_API_KEY }}"
            },
            {
              "name": "anthropic-version",
              "value": "2023-06-01"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {}
          ]
        },
        "options": {}
      },
      "id": "0920e428-f23e-46a9-a12d-5ad3f1cdf770",
      "name": "TS Infra - Claude",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        224,
        -32
      ]
    },
    {
      "parameters": {
        "jsCode": "const data = $input.item.json;\n\nconst prompt = `Voce e o Agente Troubleshooting de Containers Docker.\n\nCONTEXTO:\n- Docker Swarm ativo\n- Servicos: credgestor_api, credgestor_site, traefik\n- Rede: network_public\n\nPROBLEMA:\n${data.problem}\n\nTAREFA:\n1. Diagnosticar status dos containers\n2. Analisar logs dos servicos Docker\n3. Verificar health checks\n4. Identificar problemas de rede Docker\n\nRESPONDA EM JSON:\n{\n  \"diagnosis\": {\n    \"summary\": \"resumo\",\n    \"containerIssues\": [],\n    \"severity\": \"high|medium|low\"\n  },\n  \"recommendations\": []\n}`;\n\nreturn [{\n  json: {\n    ...data,\n    agentType: 'troubleshooting-containers',\n    prompt: prompt,\n    model: 'claude-3-5-sonnet-20241022'\n  }\n}];"
      },
      "id": "071f17ba-a383-4aa9-b696-5ca7e9faf0d2",
      "name": "TS Containers - Prompt",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        0,
        176
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.anthropic.com/v1/messages",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "x-api-key",
              "value": "={{ $env.ANTHROPIC_API_KEY }}"
            },
            {
              "name": "anthropic-version",
              "value": "2023-06-01"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {}
          ]
        },
        "options": {}
      },
      "id": "574caf38-9fa6-4b60-bca6-aff95b1fa634",
      "name": "TS Containers - Claude",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        224,
        176
      ]
    },
    {
      "parameters": {
        "jsCode": "const data = $input.item.json;\n\nconst prompt = `Voce e o Agente Troubleshooting de Banco de Dados.\n\nCONTEXTO:\n- PostgreSQL 15\n- Schemas: public, auth\n- Conexoes maximas: 100\n\nPROBLEMA:\n${data.problem}\n\nTAREFA:\n1. Diagnosticar performance do banco\n2. Analisar queries lentas\n3. Verificar conexoes ativas\n4. Identificar locks e deadlocks\n\nRESPONDA EM JSON:\n{\n  \"diagnosis\": {\n    \"summary\": \"resumo\",\n    \"dbIssues\": [],\n    \"severity\": \"high|medium|low\"\n  },\n  \"recommendations\": []\n}`;\n\nreturn [{\n  json: {\n    ...data,\n    agentType: 'troubleshooting-database',\n    prompt: prompt,\n    model: 'claude-3-5-sonnet-20241022'\n  }\n}];"
      },
      "id": "fa1a9636-b53d-419d-b2f0-9c7133168835",
      "name": "TS DB - Prompt",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        0,
        368
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.anthropic.com/v1/messages",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "x-api-key",
              "value": "={{ $env.ANTHROPIC_API_KEY }}"
            },
            {
              "name": "anthropic-version",
              "value": "2023-06-01"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {}
          ]
        },
        "options": {}
      },
      "id": "3d181788-38d4-481e-aca6-223e368b77de",
      "name": "TS DB - Claude",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        224,
        368
      ]
    },
    {
      "parameters": {
        "jsCode": "const data = $input.item.json;\n\nconst prompt = `Voce e o Agente Troubleshooting de Desenvolvimento.\n\nCONTEXTO:\n- Backend: FastAPI + Python\n- Frontend: React + TypeScript\n- API REST + WebSocket\n\nPROBLEMA:\n${data.problem}\n\nTAREFA:\n1. Diagnosticar erros de aplicacao\n2. Analisar logs de runtime\n3. Verificar APIs e endpoints\n4. Identificar bugs no codigo\n\nRESPONDA EM JSON:\n{\n  \"diagnosis\": {\n    \"summary\": \"resumo\",\n    \"codeIssues\": [],\n    \"severity\": \"high|medium|low\"\n  },\n  \"recommendations\": []\n}`;\n\nreturn [{\n  json: {\n    ...data,\n    agentType: 'troubleshooting-dev',\n    prompt: prompt,\n    model: 'claude-3-5-sonnet-20241022'\n  }\n}];"
      },
      "id": "4b1dc15e-267b-4578-a393-544092b4f795",
      "name": "TS Dev - Prompt",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        0,
        576
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.anthropic.com/v1/messages",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "x-api-key",
              "value": "={{ $env.ANTHROPIC_API_KEY }}"
            },
            {
              "name": "anthropic-version",
              "value": "2023-06-01"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {}
          ]
        },
        "options": {}
      },
      "id": "fa2e32ae-05be-4ab6-82b4-73846f8b7b6c",
      "name": "TS Dev - Claude",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        224,
        576
      ]
    },
    {
      "parameters": {
        "jsCode": "const items = $input.all();\n\nconst troubleshootingResults = items.map(item => {\n  const data = item.json;\n  let diagnosis = {};\n  \n  let responseBody = data.body || data;\n  if (typeof responseBody === 'string') {\n    try { responseBody = JSON.parse(responseBody); } catch (e) {}\n  }\n  \n  if (responseBody.content && Array.isArray(responseBody.content)) {\n    const textContent = responseBody.content.find(c => c.type === 'text');\n    const analysisText = textContent ? textContent.text : '';\n    \n    try {\n      const jsonMatch = analysisText.match(/\\{[\\s\\S]*\\}/);\n      if (jsonMatch) {\n        diagnosis = JSON.parse(jsonMatch[0]);\n      }\n    } catch (e) {}\n  }\n  \n  return {\n    agentType: data.agentType,\n    diagnosis: diagnosis\n  };\n});\n\nreturn [{\n  json: {\n    sessionId: items[0].json.sessionId,\n    timestamp: new Date().toISOString(),\n    troubleshootingResults: troubleshootingResults,\n    nextStep: 'resolution'\n  }\n}];"
      },
      "id": "04f79ea0-49c5-409b-a853-6a8eb0afcb73",
      "name": "Agregar Troubleshooting",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        448,
        272
      ]
    },
    {
      "parameters": {
        "mode": "expression",
        "output": "multipleOutputs"
      },
      "id": "7cfcf499-f92a-4746-a14b-92bebc2b5dc6",
      "name": "Switch Resolution",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [
        656,
        240
      ]
    },
    {
      "parameters": {
        "jsCode": "const data = $input.item.json;\n\nconst prompt = `Voce e o Agente Resolutor de Infraestrutura.\n\nDIAGNOSTICO:\n${JSON.stringify(data.troubleshootingResults, null, 2)}\n\nTAREFA:\nGere comandos para resolver os problemas identificados.\n\nRESPONDA EM JSON:\n{\n  \"resolution\": {\n    \"commands\": [\"comando1\", \"comando2\"],\n    \"verification\": [\"check1\", \"check2\"],\n    \"requiresApproval\": true\n  }\n}`;\n\nreturn [{\n  json: {\n    ...data,\n    agentType: 'resolutor-infra',\n    prompt: prompt,\n    model: 'claude-3-5-sonnet-20241022'\n  }\n}];"
      },
      "id": "1664dc9c-97e5-4655-888e-cbef03e75190",
      "name": "Resolutor Infra - Prompt",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        880,
        -32
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.anthropic.com/v1/messages",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "x-api-key",
              "value": "={{ $env.ANTHROPIC_API_KEY }}"
            },
            {
              "name": "anthropic-version",
              "value": "2023-06-01"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {}
          ]
        },
        "options": {}
      },
      "id": "84b36a2a-d4c0-4b80-93d2-5fab5631d168",
      "name": "Resolutor Infra - Claude",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1104,
        -32
      ]
    },
    {
      "parameters": {
        "jsCode": "const data = $input.item.json;\n\nconst prompt = `Voce e o Agente Resolutor de Containers.\n\nDIAGNOSTICO:\n${JSON.stringify(data.troubleshootingResults, null, 2)}\n\nTAREFA:\nGere comandos Docker Swarm para resolver os problemas.\n\nRESPONDA EM JSON:\n{\n  \"resolution\": {\n    \"dockerCommands\": [\"docker service update\"],\n    \"verification\": [\"docker service ls\"],\n    \"requiresApproval\": true\n  }\n}`;\n\nreturn [{\n  json: {\n    ...data,\n    agentType: 'resolutor-containers',\n    prompt: prompt,\n    model: 'claude-3-5-sonnet-20241022'\n  }\n}];"
      },
      "id": "ee5b4085-5356-4a5a-9e60-750dd9a8ba22",
      "name": "Resolutor Containers - Prompt",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        880,
        176
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.anthropic.com/v1/messages",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "x-api-key",
              "value": "={{ $env.ANTHROPIC_API_KEY }}"
            },
            {
              "name": "anthropic-version",
              "value": "2023-06-01"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {}
          ]
        },
        "options": {}
      },
      "id": "538fb2f4-fb38-43ab-b0b4-3c0fcfb52929",
      "name": "Resolutor Containers - Claude",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1104,
        176
      ]
    },
    {
      "parameters": {
        "jsCode": "const data = $input.item.json;\n\nconst prompt = `Voce e o Agente Resolutor de Banco de Dados.\n\nDIAGNOSTICO:\n${JSON.stringify(data.troubleshootingResults, null, 2)}\n\nTAREFA:\nGere queries SQL para resolver os problemas.\n\nRESPONDA EM JSON:\n{\n  \"resolution\": {\n    \"sqlCommands\": [\"SELECT\", \"UPDATE\"],\n    \"verification\": [\"SELECT count\"],\n    \"requiresApproval\": true\n  }\n}`;\n\nreturn [{\n  json: {\n    ...data,\n    agentType: 'resolutor-database',\n    prompt: prompt,\n    model: 'claude-3-5-sonnet-20241022'\n  }\n}];"
      },
      "id": "c7c78459-f1cb-4949-9a81-524aa1c98607",
      "name": "Resolutor DB - Prompt",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        880,
        368
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.anthropic.com/v1/messages",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "x-api-key",
              "value": "={{ $env.ANTHROPIC_API_KEY }}"
            },
            {
              "name": "anthropic-version",
              "value": "2023-06-01"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {}
          ]
        },
        "options": {}
      },
      "id": "cffaeabf-4188-4f07-b019-8394c66dc299",
      "name": "Resolutor DB - Claude",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1104,
        368
      ]
    },
    {
      "parameters": {
        "jsCode": "const data = $input.item.json;\n\nconst prompt = `Voce e o Agente Resolutor de Desenvolvimento.\n\nDIAGNOSTICO:\n${JSON.stringify(data.troubleshootingResults, null, 2)}\n\nTAREFA:\nGere codigo ou comandos para resolver os problemas.\n\nRESPONDA EM JSON:\n{\n  \"resolution\": {\n    \"codeChanges\": [\"mudanca1\"],\n    \"deployCommands\": [\"git pull\", \"restart\"],\n    \"requiresApproval\": true\n  }\n}`;\n\nreturn [{\n  json: {\n    ...data,\n    agentType: 'resolutor-dev',\n    prompt: prompt,\n    model: 'claude-3-5-sonnet-20241022'\n  }\n}];"
      },
      "id": "e3fcc7d1-4a05-4b22-bfef-404fdf49e1a9",
      "name": "Resolutor Dev - Prompt",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        880,
        576
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.anthropic.com/v1/messages",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "x-api-key",
              "value": "={{ $env.ANTHROPIC_API_KEY }}"
            },
            {
              "name": "anthropic-version",
              "value": "2023-06-01"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {}
          ]
        },
        "options": {}
      },
      "id": "68d50136-4847-4395-89dc-a7233101202f",
      "name": "Resolutor Dev - Claude",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1104,
        576
      ]
    },
    {
      "parameters": {
        "jsCode": "const items = $input.all();\n\nconst resolutions = items.map(item => {\n  const data = item.json;\n  let resolution = {};\n  \n  let responseBody = data.body || data;\n  if (typeof responseBody === 'string') {\n    try { responseBody = JSON.parse(responseBody); } catch (e) {}\n  }\n  \n  if (responseBody.content && Array.isArray(responseBody.content)) {\n    const textContent = responseBody.content.find(c => c.type === 'text');\n    const analysisText = textContent ? textContent.text : '';\n    \n    try {\n      const jsonMatch = analysisText.match(/\\{[\\s\\S]*\\}/);\n      if (jsonMatch) {\n        resolution = JSON.parse(jsonMatch[0]);\n      }\n    } catch (e) {}\n  }\n  \n  return {\n    agentType: data.agentType,\n    resolution: resolution\n  };\n});\n\nreturn [{\n  json: {\n    sessionId: items[0].json.sessionId,\n    timestamp: new Date().toISOString(),\n    finalResults: {\n      troubleshooting: items[0].json.troubleshootingResults || [],\n      resolutions: resolutions\n    },\n    status: 'completed'\n  }\n}];"
      },
      "id": "5f7a7efe-8008-44a6-98cd-b38f6eeeb1af",
      "name": "Agregar Resultados Finais",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1328,
        272
      ]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ JSON.stringify($json) }}",
        "options": {}
      },
      "id": "65077556-12d9-453c-8044-88b09c020d75",
      "name": "Resposta Final",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        1552,
        272
      ]
    }
  ],
  "pinData": {},
  "repo_name": "backup-n8n",
  "repo_owner": "faelsou",
  "repo_path": "backups",
  "settings": {
    "executionOrder": "v1"
  },
  "shared": [
    {
      "createdAt": "2026-01-23T07:02:16.829Z",
      "updatedAt": "2026-01-23T07:02:16.829Z",
      "role": "workflow:owner",
      "workflowId": "BxvIVnNnNggVgVAC",
      "projectId": "uxvBhUmI1Fx6jdU7"
    }
  ],
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2026-01-23T07:02:16.829Z",
  "versionId": "53c6f553-e166-4573-8cd7-158ac72f4fc1"
}